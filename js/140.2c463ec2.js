"use strict";(self["webpackChunkvue_template"]=self["webpackChunkvue_template"]||[]).push([[140],{6140:function(e,t,n){n.r(t),n.d(t,{default:function(){return x}});var s=n(3396);function o(e,t,n,o,r,i){const a=(0,s.up)("LoginForm");return(0,s.wg)(),(0,s.j4)(a)}var r=n(9242);const i=e=>((0,s.dD)("data-v-0cf0ae8e"),e=e(),(0,s.Cn)(),e),a={class:"border w-50 p-5 pb-0"},l=i((()=>(0,s._)("h2",null,"登入",-1))),c=i((()=>(0,s._)("label",{for:"account"},"帳號",-1))),d={ref:"username",class:"text-danger"},u=i((()=>(0,s._)("br",null,null,-1))),m=i((()=>(0,s._)("label",{for:"password"},"密碼",-1))),h={ref:"password",class:"text-danger"},g=i((()=>(0,s._)("br",null,null,-1))),p={ref:"loginFeedback",class:"text-danger"},f=i((()=>(0,s._)("div",{class:"mt-3 mb-5"},[(0,s._)("button",{class:"btn btn-primary w-100 mb-2",type:"submit"},"登入")],-1)));function b(e,t,n,o,i,b){const F=(0,s.up)("IsLoading");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("form",{class:"center-center",onSubmit:t[2]||(t[2]=(0,r.iM)(((...e)=>b.sendLoginForm&&b.sendLoginForm(...e)),["prevent"]))},[(0,s._)("section",a,[l,c,(0,s.wy)((0,s._)("input",{type:"text",id:"account",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=e=>i.userLoginForm.username=e)},null,512),[[r.nr,i.userLoginForm.username]]),(0,s._)("i",d,null,512),u,m,(0,s.wy)((0,s._)("input",{type:"password",id:"password",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>i.userLoginForm.password=e)},null,512),[[r.nr,i.userLoginForm.password]]),(0,s._)("i",h,null,512),g,(0,s._)("i",p,null,512),f])],32),(0,s.Wm)(F,{active:e.isLoading,"onUpdate:active":t[3]||(t[3]=t=>e.isLoading=t)},null,8,["active"])],64)}var F=n(65),L={data(){return{userLoginForm:{username:"",password:""},i18n:{username:"帳號",password:"密碼","The email address is badly formatted.":"Email 格式錯誤!!!","The password is invalid or the user does not have a password.":"密碼錯誤!!!"}}},computed:{...(0,F.rn)(["isLoading"])},methods:{async sendLoginForm(){this.validate()&&await this.login()},validate(){let e="";const t=Object.values(this.userLoginForm);return t.length<2?(this.unfilledFeedback(),e=!1):(this.clearUnfilledFeedback(),e=!0,t.forEach((t=>{""===t&&(this.unfilledFeedback(),e=!1)}))),e},unfilledFeedback(){Object.keys(this.userLoginForm).forEach((e=>{this.userLoginForm[e]||(this.$refs[e].textContent=`${this.i18n[e]} 欄位尚未填寫`)}))},clearUnfilledFeedback(){Object.keys(this.userLoginForm).forEach((e=>{this.userLoginForm[e]&&(this.$refs[e].textContent="")}))},login(){return new Promise(((e,t)=>{this.$store.commit("OPEN_LOADING");const n="https://vue3-course-api.hexschool.io/v2/admin/signin";console.log(n),this.$http.post(n,this.userLoginForm).then((e=>{console.log(e),this.$store.commit("CLOSE_LOADING");const{token:t,expired:n}=e.data;document.cookie=`loginToken=${t};expires=${new Date(n)};`,this.$router.push("/checkLogin")})).catch((e=>{console.log(e),this.$store.commit("CLOSE_LOADING"),this.loginFailFeedback(e.response.data.error.message)})),e()}))},loginFailFeedback(e){this.i18n[e]?this.$refs.loginFeedback.textContent=`${this.i18n[e]}`:this.$refs.loginFeedback.textContent="您輸入的帳號錯誤 或 密碼錯誤太多次遭到鎖定，請重新更改密碼即可正常使用!!"}},mounted(){}},v=n(89);const w=(0,v.Z)(L,[["render",b],["__scopeId","data-v-0cf0ae8e"]]);var _=w,k={components:{LoginForm:_},data(){return{}},mounted(){}};const $=(0,v.Z)(k,[["render",o]]);var x=$}}]);
//# sourceMappingURL=140.2c463ec2.js.map